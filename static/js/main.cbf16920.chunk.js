(this.webpackJsonpbiriba=this.webpackJsonpbiriba||[]).push([[0],{23:function(e,t,a){e.exports=a(42)},28:function(e,t,a){},30:function(e,t,a){},31:function(e,t,a){},32:function(e,t,a){},33:function(e,t,a){},39:function(e,t,a){},40:function(e,t,a){},41:function(e,t,a){},42:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),s=a(21),r=a.n(s),l=(a(28),a(13)),o=a.n(l),c=a(15),u=a(4),m=a(5),d=a(1),p=a(7),h=a(6),b=(a(30),a(31),function(e){Object(p.a)(a,e);var t=Object(h.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"render",value:function(){return i.a.createElement("div",{className:"Login"},i.a.createElement("div",{className:"login-container"},i.a.createElement("div",{className:"intro"},i.a.createElement("h1",null,"Welcome to Biriba Notes"),i.a.createElement("p",null,"Here you can here you can here you can here you can here you can here you can here")),i.a.createElement("button",{onClick:this.props.signInFunction},"Login with Google")))}}]),a}(i.a.Component)),f=(a(32),a(33),a(11)),g=a(2),y=function(e){Object(p.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).state={numberOfPlayers:0,numberOfTeams:0,players:[],teams:[]},n.onChangeNumberOfPlayers=n.onChangeNumberOfPlayers.bind(Object(d.a)(n)),n.submitNumberOfPlayers=n.submitNumberOfPlayers.bind(Object(d.a)(n)),n.onChangePlayerNames=n.onChangePlayerNames.bind(Object(d.a)(n)),n.submitNumberOfTeams=n.submitNumberOfTeams.bind(Object(d.a)(n)),n.onChangeNumberOfTeams=n.onChangeNumberOfTeams.bind(Object(d.a)(n)),n.getAvailablePlayers=n.getAvailablePlayers.bind(Object(d.a)(n)),n.addPlayerToTeam=n.addPlayerToTeam.bind(Object(d.a)(n)),n.removePlayerFromTeam=n.removePlayerFromTeam.bind(Object(d.a)(n)),n.createGameNote=n.createGameNote.bind(Object(d.a)(n)),n.getDateToString=n.getDateToString.bind(Object(d.a)(n)),n}return Object(m.a)(a,[{key:"onChangeNumberOfPlayers",value:function(e){this.setState({numberOfPlayers:e.target.value,players:[]})}},{key:"submitNumberOfPlayers",value:function(){if(this.state.numberOfPlayers>1&&this.state.numberOfPlayers<=20){for(var e=[],t=0;t<this.state.numberOfPlayers;t++)e.push({id:t,name:""});this.setState({players:e})}}},{key:"onChangePlayerNames",value:function(e){var t=e.target.id.split("_")[1],a=e.target.value,n=this.state.players;n[t].name=a,this.setState({players:n})}},{key:"onChangeNumberOfTeams",value:function(e){this.setState({teams:[],numberOfTeams:e.target.value})}},{key:"submitNumberOfTeams",value:function(){if(this.state.numberOfTeams>=2&&this.state.numberOfTeams<=this.state.numberOfPlayers){var e=!1;if(this.state.players.forEach((function(t,a){""===t.name&&(e=!0)})),!e)for(var t=[],a=0;a<this.state.numberOfTeams;a++)t.push({id:a,members:[]}),this.setState({teams:t})}}},{key:"getAvailablePlayers",value:function(){var e=this;if(this.state.players!==[]&&this.state.teams!==[]&&this.state.teams.members!==[]){var t=[];return this.state.players.forEach((function(a,n){var i=!0;e.state.teams.forEach((function(e,t){e.members.forEach((function(e,t){Number(a.id)===Number(e.id)&&(i=!1)}))})),i&&t.push(a)})),t}return null}},{key:"addPlayerToTeam",value:function(e){var t=e.target.id.split("_"),a=t[1],n=t[2],i=this.state.teams;i[n].members.push({id:a}),this.setState({teams:i})}},{key:"removePlayerFromTeam",value:function(e){var t=e.target.id.split("_")[1],a=[];this.state.teams.forEach((function(e,n){var i=[];e.members.forEach((function(e,a){Number(e.id)!==Number(t)&&i.push({id:e.id})})),a.push({id:e.id,members:i})})),this.setState({teams:a})}},{key:"createGameNote",value:function(){if(this.props.biribaNotes){var e=this.props.biribaNotes,t={number:0,scores:[]};this.state.teams.forEach((function(e,a){t.scores.push({teamId:e.id,countCardsScore:0,biribaScore:0})}));var a={id:e.unfinishedGames.length+1,date:this.getDateToString(),teams:this.state.teams,players:this.state.players,rounds:[t],finished:!1};e.unfinishedGames.push(a),this.props.updateBiribaNotes(e),console.log("calling update existing file..."),this.props.updateFile()}else{var n={number:1,scores:[]};this.state.teams.forEach((function(e,t){n.scores.push({teamId:e.id,countCardsScore:0,biribaScore:0})}));var i=this.props.biribaNotes;i={unfinishedGames:[{id:0,date:this.getDateToString(),teams:this.state.teams,players:this.state.players,rounds:[n],finished:!1}],finishedGames:[]},this.props.updateBiribaNotes(i),console.log("calling upload new file..."),this.props.uploadFile()}this.props.history.push("/biriba")}},{key:"getDateToString",value:function(){var e=new Date,t=e.getFullYear(),a=e.getMonth()+1;a=a<10?"0"+a:a;var n=e.getDate();n=n<10?"0"+n:n;var i=e.getHours()+1;i=i<10?"0"+i:i;var s=e.getMinutes();return n+"/"+a+"/"+t+"|"+i+":"+(s=s<10?"0"+s:s)}},{key:"render",value:function(){var e=this,t=[];if(this.state.players!==[]){var a=!1;this.state.players.forEach((function(n,s){a=!0,t.push(i.a.createElement("div",{className:"player-section",key:"playersDiv"+s},i.a.createElement("p",{className:"title"},"Player: ",s+1),i.a.createElement("input",{type:"text",maxLength:"20",id:"playerName_"+s,value:e.state.players[s].name,onChange:e.onChangePlayerNames,required:!0}),i.a.createElement("p",null,"Name")))})),a&&(t.unshift(i.a.createElement("div",{className:"line",key:"playersDiv_0000"})),t.push(i.a.createElement("div",{className:"section",key:"playersDiv9999"},i.a.createElement("input",{type:"number",placeholder:"2",maxLength:"2",minLength:"1",max:this.state.numberOfPlayers,min:"2",value:this.state.numberOfTeams,onChange:this.onChangeNumberOfTeams,required:!0}),i.a.createElement("p",null,"Number of teams"),i.a.createElement("button",{type:"submit",style:{height:"40px"},className:"submit-players-button",onClick:this.submitNumberOfTeams},"Submit names and number of teams"))))}var n=[];if(this.state.teams!==[]){var s=!1;this.state.teams.forEach((function(t,a){s=!0;var r=e.getAvailablePlayers(),l=[];r.forEach((function(a,n){l.push(i.a.createElement("button",{id:"availablePlayer_"+a.id+"_"+t.id,onClick:e.addPlayerToTeam,key:"availablePlayer_"+n,className:"tag"},a.name))})),r!==[]&&null!==r&&0!==r.length||(l=i.a.createElement("p",{className:"msg"},"No available players left"));var o=[];t.members.forEach((function(a,n){o.push(i.a.createElement("button",{id:"selectedPlayer_"+a.id+"_"+t.id,onClick:e.removePlayerFromTeam,key:"selectedPlayer_"+n,className:"tag"},e.state.players[a.id].name))})),0===o.length&&(o=i.a.createElement("p",{className:"msg"},"No members yet")),n.push(i.a.createElement("div",{className:"player-section",key:"teamsDiv"+a},i.a.createElement("p",{className:"title"},"Team: ",a+1),i.a.createElement("div",{className:"add-players-div"},i.a.createElement("div",{className:"player-tags"},i.a.createElement("p",null,"Selected players"),o),i.a.createElement("div",{className:"player-tags"},i.a.createElement("p",null,"Available players"),l))))})),s&&(n.unshift(i.a.createElement("div",{className:"line",key:"teamsDiv_0000"})),n.push(i.a.createElement("div",{className:"section",key:"teamsDiv9910"},i.a.createElement("button",{type:"submit",style:{height:"40px",backgroundColor:"#1B9AAA"},className:"submit-players-button",onClick:this.createGameNote},"Create game note"))))}return i.a.createElement("div",{className:"NewGame"},i.a.createElement("div",{className:"NewGame-container"},i.a.createElement("div",{className:"header"},i.a.createElement("p",null,"New Game"),i.a.createElement(f.b,{to:"/biriba"},i.a.createElement("i",{className:"fa fa-arrow-left"}))),i.a.createElement("div",{className:"line"}),i.a.createElement("div",{className:"section"},i.a.createElement("input",{type:"number",placeholder:"2",maxLength:"2",minLength:"1",max:"20",min:"2",value:this.state.numberOfPlayers,onChange:this.onChangeNumberOfPlayers}),i.a.createElement("p",null,"Number of players"),i.a.createElement("button",{type:"submit",className:"submit-players-button",onClick:this.submitNumberOfPlayers},"Submit number of players")),t,n))}}]),a}(i.a.Component),v=Object(g.f)(y),N=(a(39),function(e){Object(p.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).enterUnfinishedGame=n.enterUnfinishedGame.bind(Object(d.a)(n)),n}return Object(m.a)(a,[{key:"enterUnfinishedGame",value:function(e){var t=e.target.id.split("_")[1];this.props.updateUnfinishedGameId(t),this.props.history.push("/biriba/unfinished-games/game")}},{key:"render",value:function(){var e=this,t=[];return this.props.biribaNotes&&this.props.biribaNotes.unfinishedGames&&this.props.biribaNotes.unfinishedGames.forEach((function(a,n){var s=-1;a.teams.forEach((function(e,t){var n=0;a.rounds.forEach((function(t,a){t.scores.forEach((function(t,a){Number(e.id)===Number(t.id)&&(n+=t.biribaScore+t.countCardsScore)}))})),s<n&&(s=n)})),t.push(i.a.createElement("div",{className:"UnfinishedGame-part",key:"UnfinishedGame-part"+n,id:"unfinishedGame_"+a.id,onClick:e.enterUnfinishedGame},i.a.createElement("p",{className:"title"},"Game:#",n),i.a.createElement("div",{className:"inline"},i.a.createElement("i",{className:"fa fa-calendar"}),i.a.createElement("p",{className:"date"},a.date)),i.a.createElement("p",null,"Players: ",a.players.length),i.a.createElement("p",null,"Max score: ",s),i.a.createElement("p",null,"Teams: ",a.teams.length),i.a.createElement("p",null,"Current round: ",a.rounds.length)))})),t===[]&&(t=i.a.createElement("p",null,"No unfinished games available")),i.a.createElement("div",{className:"UnfinishedGames"},i.a.createElement("div",{className:"UnfinishedGames-container"},i.a.createElement("div",{className:"header"},i.a.createElement("p",null,"Unfinished Games"),i.a.createElement(f.b,{to:"/biriba"},i.a.createElement("i",{className:"fa fa-arrow-left"}))),i.a.createElement("div",{className:"line"}),i.a.createElement("div",{className:"section"},t)),";")}}]),a}(i.a.Component)),E=Object(g.f)(N),O=(a(40),function(e){Object(p.a)(a,e);var t=Object(h.a)(a);function a(e){return Object(u.a)(this,a),t.call(this,e)}return Object(m.a)(a,[{key:"render",value:function(){return i.a.createElement("div",{className:"UnfinishedGame"},i.a.createElement("div",{className:"UnfinishedGame-container"},i.a.createElement("div",{className:"header"},i.a.createElement("p",null,"Unfinished Game ",this.props.unfinishedGameId),i.a.createElement(f.b,{to:"/biriba/unfinished-games"},i.a.createElement("i",{className:"fa fa-arrow-left"}))),i.a.createElement("div",{className:"line"}),i.a.createElement("div",{className:"section"},"game info here")),";")}}]),a}(i.a.Component)),j=function(e){Object(p.a)(a,e);var t=Object(h.a)(a);function a(e){return Object(u.a)(this,a),t.call(this,e)}return Object(m.a)(a,[{key:"render",value:function(){return i.a.createElement(f.a,null,i.a.createElement("div",{className:"Menu"},i.a.createElement(g.c,null,i.a.createElement(g.a,{exact:!0,path:"/biriba"},i.a.createElement("div",{className:"menu-container"},i.a.createElement("div",{className:"intro"},i.a.createElement("h1",null,"Menu")),i.a.createElement(f.b,{to:"/biriba/new-game"},i.a.createElement("i",{className:"fa fa-plus"}),i.a.createElement("p",null,"New Game Notes")),i.a.createElement(f.b,{to:"/biriba/unfinished-games"},i.a.createElement("i",{className:"fa fa-edit"}),i.a.createElement("p",null,"Unfinished Game Notes")),i.a.createElement(f.b,{to:"/biriba/history"},i.a.createElement("i",{className:"fa fa-clipboard"}),i.a.createElement("p",null,"History")))),i.a.createElement(g.a,{exact:!0,path:"/biriba/new-game"},i.a.createElement(v,{biribaNotes:this.props.biribaNotes,updateBiribaNotes:this.props.updateBiribaNotes,uploadFile:this.props.uploadFile,updateFile:this.props.updateFile})),i.a.createElement(g.a,{exact:!0,path:"/biriba/unfinished-games"},i.a.createElement(E,{biribaNotes:this.props.biribaNotes,updateBiribaNotes:this.props.updateBiribaNotes,uploadFile:this.props.uploadFile,updateFile:this.props.updateFile,updateUnfinishedGameId:this.props.updateUnfinishedGameId,unfinishedGameId:this.props.unfinishedGameId})),i.a.createElement(g.a,{exact:!0,path:"/biriba/unfinished-games/game"},i.a.createElement(O,{UnfinishedGameId:this.props.unfinishedGameId,biribaNotes:this.props.biribaNotes,updateBiribaNotes:this.props.updateBiribaNotes,uploadFile:this.props.uploadFile,updateFile:this.props.updateFile})))))}}]),a}(i.a.Component),S=(a(41),function(e){Object(p.a)(a,e);var t=Object(h.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"render",value:function(){return i.a.createElement("div",{className:"Logout"},i.a.createElement("div",{className:"logout-container"},i.a.createElement("div",{className:"user"},i.a.createElement("i",{className:"fa fa-user"}),i.a.createElement("p",null,this.props.userMail)),i.a.createElement("button",{onClick:this.props.signOutFunction},i.a.createElement("i",{className:"fa fa-sign-out"}))))}}]),a}(i.a.Component)),C=function(){function e(){Object(u.a)(this,e)}return Object(m.a)(e,null,[{key:"getAPIKey",value:function(){return"AIzaSyDx-UwZd7JuuZZEKaA5OeCXpiWr4PGul9I"}},{key:"getClientID",value:function(){return"286520596166-kcoq2cmrbd0cejleemk2viuq6rguivhj.apps.googleusercontent.com"}}]),e}(),k="https://www.googleapis.com/auth/drive",F=C.getAPIKey(),G=C.getClientID(),T=function(e){Object(p.a)(a,e);var t=Object(h.a)(a);function a(){var e;return Object(u.a)(this,a),(e=t.call(this)).handleClientLoad=function(){window.gapi.load("client:auth2",e.initClient)},e.initClient=function(){try{window.gapi.client.init({apiKey:F,clientId:G,scope:k,discoveryDocs:["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"]}).then((function(){e.setState({googleAuth:window.gapi.auth2.getAuthInstance()}),e.state.googleAuth.isSignedIn.listen(e.updateSigninStatus)}))}catch(t){console.log(t)}},e.signInFunction=function(){try{e.state.googleAuth.signIn(),e.updateSigninStatus()}catch(t){console.log(t)}},e.signOutFunction=function(){e.state.googleAuth.signOut(),e.updateSigninStatus()},e.updateSigninStatus=function(){e.setSigninStatus()},e.setSigninStatus=Object(c.a)(o.a.mark((function t(){var a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({userMail:""}),t.next=3,e.state.googleAuth.currentUser.get();case 3:a=t.sent,a.hasGrantedScopes(k)&&e.setState({userMail:a.vt.cu}),e.readFile().then((function(t){console.log("File read : "+t),e.setState({biribaNotes:JSON.parse(t.body)})})).catch((function(e){console.log("No available file : "+e)}));case 7:case"end":return t.stop()}}),t)}))),e.checkFileExists=Object(c.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){window.gapi.client.drive.files.list({q:"name='biriba-notes'"}).execute((function(a){a.files&&a.files.length&&a.files[0].id?e(a.files[0].id):t(null)}))})));case 1:case"end":return e.stop()}}),e)}))),e.readFile=Object(c.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,a){e.checkFileExists().then((function(n){e.setState({fileId:n}),window.gapi.client.drive.files.get({fileId:n,alt:"media"}).then((function(e){console.log("file with this id found"),t(e)})).catch((function(e){console.log("file with this id does not exist"),a("ID_NOT_EXIST")}))})).catch((function(e){console.log("file with this name does not exist"),a("NAME_NOT_EXIT")}))})));case 1:case"end":return t.stop()}}),t)}))),e.uploadFile=function(){var t="-------314159265358979323846264",a="\r\n--"+t+"\r\n",n=btoa(JSON.stringify(e.state.biribaNotes)),i=a+"Content-Type: application/json\r\n\r\n"+JSON.stringify({title:"biriba-notes"})+a+"Content-Type: text/plain\r\nContent-Transfer-Encoding: base64\r\n\r\n"+n+"\r\n---------314159265358979323846264--";window.gapi.client.request({path:"/upload/drive/v2/files",method:"POST",params:{uploadType:"multipart"},headers:{"Content-Type":'multipart/mixed; boundary="'+t+'"'},body:i}).execute((function(e){console.log("New file upploaded!")}))},e.updateFile=function(){var t="-------314159265358979323846264",a="\r\n--"+t+"\r\n",n=btoa(JSON.stringify(e.state.biribaNotes)),i=a+"Content-Type: application/json\r\n\r\n"+JSON.stringify({title:"biriba-notes"})+a+"Content-Type: text/plain\r\nContent-Transfer-Encoding: base64\r\n\r\n"+n+"\r\n---------314159265358979323846264--";window.gapi.client.request({path:"/upload/drive/v2/files/"+e.state.fileId,method:"PUT",params:{uploadType:"multipart",alt:"json"},headers:{"Content-Type":'multipart/mixed; boundary="'+t+'"'},body:i}).execute((function(e){console.log("File updated!")}))},e.state={name:"",googleAuth:"",userMail:"",biribaNotes:{},fileId:"",unfinishedGameId:-1},e.initClient=e.initClient.bind(Object(d.a)(e)),e.signInFunction=e.signInFunction.bind(Object(d.a)(e)),e.signOutFunction=e.signOutFunction.bind(Object(d.a)(e)),e.updateSigninStatus=e.updateSigninStatus.bind(Object(d.a)(e)),e.handleClientLoad=e.handleClientLoad.bind(Object(d.a)(e)),e.setSigninStatus=e.setSigninStatus.bind(Object(d.a)(e)),e.checkFileExists=e.checkFileExists.bind(Object(d.a)(e)),e.readFile=e.readFile.bind(Object(d.a)(e)),e.uploadFile=e.uploadFile.bind(Object(d.a)(e)),e.updateBiribaNotes=e.updateBiribaNotes.bind(Object(d.a)(e)),e.updateFile=e.updateFile.bind(Object(d.a)(e)),e.updateUnfinishedGameId=e.updateUnfinishedGameId.bind(Object(d.a)(e)),e}return Object(m.a)(a,[{key:"componentDidMount",value:function(){var e=document.createElement("script");e.onload=this.handleClientLoad,e.src="https://apis.google.com/js/api.js",document.body.appendChild(e)}},{key:"updateBiribaNotes",value:function(e){this.setState({biribaNotes:e})}},{key:"updateUnfinishedGameId",value:function(e){this.setState({unfinishedGameId:e})}},{key:"render",value:function(){var e="",t="";return""===this.state.userMail||void 0===this.state.userMail?e=i.a.createElement(b,{signInFunction:this.signInFunction}):(e=i.a.createElement(j,{biribaNotes:this.state.biribaNotes,updateBiribaNotes:this.updateBiribaNotes,uploadFile:this.uploadFile,updateFile:this.updateFile,updateUnfinishedGameId:this.updateUnfinishedGameId,unfinishedGameId:this.unfinishedGameId}),t=i.a.createElement(S,{userMail:this.state.userMail,signOutFunction:this.signOutFunction})),i.a.createElement("div",{className:"App"},t,e)}}]),a}(i.a.Component);r.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(T,null)),document.getElementById("root"))}},[[23,1,2]]]);
//# sourceMappingURL=main.cbf16920.chunk.js.map